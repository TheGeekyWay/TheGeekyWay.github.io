<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="//thegeekyway.com/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="//thegeekyway.com/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="//thegeekyway.com/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="The Geeky Way">
  <meta name="description" content="Posts and writings by The Geeky Way">

  <link href="//thegeekyway.com/feed/all.atom.xml" type="application/atom+xml" rel="alternate" title="The Geeky Way Atom" />
  <link href="//thegeekyway.com/feed/index.html" type="application/rss+xml" rel="alternate" title="The Geeky Way RSS" />

<meta name="keywords" content="asp.net, C#">

  <title>
    The Geeky Way
&ndash; Asp.net Basics : Uploading a file in asp.net using validations (Part 4 of 5)  </title>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46055942-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="//thegeekyway.com">
        <img src="/uploads/images/tgw.png" alt="logo">
      </a>
      <h2><a href="//thegeekyway.com">The Geeky Way</a></h2>
      <p></p>
      <ul>
        <li><a href="/categories.html" target="_blank">Categories</a></li>
        <li><a href="/tags.html" target="_blank">Tags</a></li>
        <li><a href="/archives.html" target="_blank">Archives</a></li>
        <li><a href="/about-us/" target="_blank">About us</a></li>
        <li><a href="/authors.html" target="_blank">Authors</a></li>
        <hr>
        <p><b>Social Media</b></p>
        <a href="https://www.twitter.com/thegeekyway" target="_blank">
          <img src="/icons/twitter.png" style="width:25px;height:25px;border:0;">
        </a>
        <a href="https://www.facebook.com/thegeekyway" target="_blank">
          <img src="/icons/facebook.png" style="width:25px;height:25px;border:0;">
        </a>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      Technology Inside Out!
      <br><br>
      <a href="//thegeekyway.com">Index</a> &brvbar; <a href="//thegeekyway.com/archives.html">Archives</a>
      &brvbar; <a href="//thegeekyway.com/feed/all.atom.xml">Atom</a>
      &brvbar; <a href="//thegeekyway.com/feed/">RSS</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="//thegeekyway.com/asp-net-basics-uploading-a-file-in-asp-net-using-validations-part-4/">Asp.net Basics : Uploading a file in asp.net using validations (Part 4 of 5)</a></h1>
  </div>
  <div class="article_author">
    <p><strong>By: <a href=//thegeekyway.com/author/deep_singh/>Deep_Singh</a></strong></p>
  </div>
  <div class="article_text">
    <p><center>
<u>This is a part 4 of the 5 part tutorial.</u><br>
If you are visiting this page for the first time then you must visit part 1 of the tutorial<br>
on how to upload a file on server <a href="http://www.thegeekyway.com/uploading-a-file-in-asp-part-1/">here</a>
</center></p>
<p>Contents of this 5 part tutorial<br>
Part 1 : <a href="http://www.thegeekyway.com/uploading-a-file-in-asp-part-1/">Basics of ASP.Net file uploading, uploading a file to a server.</a><br>
Part 2 : <a href="http://www.thegeekyway.com/asp-net-basics-uploading-a-file-in-asp-net-using-validations-part-2/">ASP.Net file uploading using EmptyFile Validations.</a><br>
Part 3 : <a href="http://www.thegeekyway.com/asp-net-basics-uploading-a-file-in-asp-net-using-validations-part-3/">ASP.Net file uploading using FileSize validation.</a><br>
Part 4 : <a href="http://www.thegeekyway.com/asp-net-basics-uploading-a-file-in-asp-net-using-validations-part-4/">ASP.Net file uploading using FileExtension validator.</a><br>
Part 5 : <a href="http://www.thegeekyway.com/asp-net-basics-uploading-file-asp-net-using-validations-part-5/">Complete ASP.Net file uploading using all the Validations one at a time.</a></p>
<div style="text-align:center">
<p><a href="//thegeekyway.com/uploads/images/2014/01/FileUploadTut4-1.png"><img alt="FileUploadTut4-1" src="//thegeekyway.com/uploads/images/2014/01/FileUploadTut4-1.png"></a></p>
</div>
<hr>
<h2><strong><em>*File Upload in asp.net : v1.3 (File Extension Validation)</em></strong>*</h2>
<p>This is the final part of the 5 part tutorial where we'll discuss about the FileExtension validations during file uploading. Some of the professional companies demand that the resume should be in .doc or .docx or .pdf extension only, so the main point arises what if the user uploads the file in some other extension (for example : in .txt file), there should be a validator for that to validate the extension of the file. Fortunately in Microsoft Visual Studio we can do that, there is a method <strong>GetExtension()</strong> which gets the extension of the file and has a return type of <strong>string</strong>.</p>
<p>GetExtension() method is saved in class <strong>Path</strong> which is the part of <strong>System.IO</strong> and returns a string. The complete syntax for using FileExtension validation is :-</p>
<blockquote>
<p><strong>string</strong> GetFileExtension = <strong>Path</strong>.<strong>GetExtension</strong>(FileUpload1.FileName);</p>
</blockquote>
<p>where FileUpload1 is the fileupload control and FileName gets the current file which is being uploaded.</p>
<p>Using this method we can get the file extension and we can compare the values using if-else.</p>
<p>The complete <a href="http://www.thegeekyway.com/tag/c-2/">C#</a> code is</p>
<div class="highlight"><pre><span></span>    <span class="nv">private</span> <span class="nv">void</span> <span class="nv">GetFileExtension</span><span class="ss">()</span>
    {
        <span class="nv">string</span> <span class="nv">GetFileExtension</span> <span class="o">=</span> <span class="nv">Path</span>.<span class="nv">GetExtension</span><span class="ss">(</span><span class="nv">FileUpload1</span>.<span class="nv">FileName</span><span class="ss">)</span><span class="c1">;</span>
        <span class="k">if</span> <span class="ss">(</span><span class="nv">GetFileExtension</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">.pdf</span><span class="s2">&quot;</span><span class="ss">)</span>
        {
            <span class="nv">Image1</span>.<span class="nv">ImageUrl</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">~//images//success.png</span><span class="s2">&quot;</span><span class="c1">;</span>
            <span class="nv">File_Extension</span>.<span class="nv">Text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">File Extension OK ! File will be uploaded</span><span class="s2">&quot;</span><span class="c1">;</span>
            <span class="nv">File_Extension</span>.<span class="nv">ForeColor</span> <span class="o">=</span> <span class="nv">Color</span>.<span class="nv">GreenYellow</span><span class="c1">;</span>
            <span class="o">//</span> <span class="nv">Provide</span> <span class="nv">upload</span> <span class="nv">code</span> <span class="ss">(</span><span class="nv">discussed</span> <span class="nv">in</span> <span class="nv">part</span> <span class="mi">1</span> <span class="nv">of</span> <span class="nv">this</span> <span class="nv">tutorial</span><span class="ss">)</span>
        }
        <span class="k">else</span>
        {
            <span class="nv">File_Extension</span>.<span class="nv">Text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">File Extension detected : &#39;</span><span class="s2">&quot;</span> <span class="o">+</span><span class="nv">GetFileExtension</span><span class="o">+</span> <span class="s2">&quot;</span><span class="s">&#39;. Required file extension : &#39;.pdf&#39; </span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="s">File Not uploaded</span><span class="s2">&quot;</span> <span class="c1">;</span>
            <span class="nv">File_Extension</span>.<span class="nv">ForeColor</span> <span class="o">=</span> <span class="nv">Color</span>.<span class="nv">Red</span><span class="c1">;</span>
            <span class="nv">Image1</span>.<span class="nv">ImageUrl</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">~//images//not_success.png</span><span class="s2">&quot;</span><span class="c1">;</span>
        }
    }
</pre></div>


<p>Output of the current code will be</p>
<div style="text-align:center">
<p><a href="//thegeekyway.com/uploads/images/2014/01/FileUploadTut4-2.png"><img alt="FileUploadTut4-2" src="//thegeekyway.com/uploads/images/2014/01/FileUploadTut4-2.png"></a></p>
</div>
<p>Thats the final part of the file upload system, in the next tutorial we'll add up all the part of this tutorial and present the final part of asp.net file upload tutorial.</p>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 06 January 2014</p>
    <p>Category: <a href="//thegeekyway.com/category/aspnet-dot-net/">Asp.net (Dot Net)</a>
 &ndash; Tags:
      <a href="//thegeekyway.com/tag/aspnet/">asp.net</a>,      <a href="//thegeekyway.com/tag/c/">C#</a>    </p>
  </div>

  <div id="article_comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = "asp-net-basics-uploading-a-file-in-asp-net-using-validations-part-4/";
        (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = '//thegeekyway.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
         })();
    </script>
  </div>

</article>


    <div id="ending_message">
      <p>&copy; The Geeky Way. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
      <a href="/disclaimer/">Disclaimer</a> 
      <a href="/privacy-policy/">Privacy policy</a>
    </div>
  </main>
</body>
</html>